{{/* 联系我们板块 - 适配Tailwind明暗模式 + 完善表单验证 */}}
<section id="contact" class="section-padding bg-primary dark:bg-gray-800 text-white dark:text-gray-100 transition-colors duration-300">
  <div class="container mx-auto px-4 sm:px-6 lg:px-8">
    <!-- 标题区域（适配Hugo多语言 + 明暗模式） -->
    <div class="text-center mb-16">
      <h2 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold mb-4 dark:text-white">
        {{ i18n "contact.title" | default "联系我们" }}
      </h2>
      <p class="text-gray-300 dark:text-gray-400 max-w-2xl mx-auto text-lg">
        {{ i18n "contact.desc" | default "如有任何疑问或合作意向，欢迎随时联系我们，我们将尽快回复您" }}
      </p>
    </div>

    <div class="flex flex-col lg:flex-row gap-12">
      <!-- 表单区域（核心：明暗模式样式适配） -->
      <div class="lg:w-1/2">
        <form id="contactForm" class="space-y-6">
          <!-- 姓名 + 邮箱 -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label for="name" class="block text-sm font-medium mb-2 dark:text-gray-200">
                {{ i18n "contact.name" | default "姓名" }}
              </label>
              <input 
                type="text" 
                id="name"
                placeholder="{{ i18n "contact.name_placeholder" | default "请输入您的姓名" }}"
                class="w-full px-4 py-3 rounded-md bg-white/10 dark:bg-gray-700 border border-white/20 dark:border-gray-600 text-white dark:text-gray-100 placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-secondary dark:focus:ring-secondary focus:border-transparent transition-all"
              >
            </div>
            <div>
              <label for="email" class="block text-sm font-medium mb-2 dark:text-gray-200">
                {{ i18n "contact.email" | default "邮件" }} *
              </label>
              <input 
                type="email" 
                id="email"
                placeholder="{{ i18n "contact.email_placeholder" | default "请输入您的邮箱" }}"
                class="w-full px-4 py-3 rounded-md bg-white/10 dark:bg-gray-700 border border-white/20 dark:border-gray-600 text-white dark:text-gray-100 placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-secondary dark:focus:ring-secondary focus:border-transparent transition-all"
                required
              >
              <p id="emailError" class="text-red-400 dark:text-red-500 text-sm hidden mt-1">
                {{ i18n "contact.email_error" | default "请输入有效的邮箱地址" }}
              </p>
            </div>
          </div>

          <!-- 电话 + 公司名称 -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label for="phone" class="block text-sm font-medium mb-2 dark:text-gray-200">
                {{ i18n "contact.phone" | default "电话" }} *
              </label>
              <input 
                type="tel" 
                id="phone"
                placeholder="{{ i18n "contact.phone_placeholder" | default "请输入您的联系电话" }}"
                class="w-full px-4 py-3 rounded-md bg-white/10 dark:bg-gray-700 border border-white/20 dark:border-gray-600 text-white dark:text-gray-100 placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-secondary dark:focus:ring-secondary focus:border-transparent transition-all"
                required
              >
              <p id="phoneError" class="text-red-400 dark:text-red-500 text-sm hidden mt-1">
                {{ i18n "contact.phone_error" | default "请输入有效的联系电话（11位手机号/固定电话）" }}
              </p>
            </div>
            <div>
              <label for="company" class="block text-sm font-medium mb-2 dark:text-gray-200">
                {{ i18n "contact.company" | default "公司名称" }}
              </label>
              <input 
                type="text" 
                id="company"
                placeholder="{{ i18n "contact.company_placeholder" | default "请输入您的公司名称（选填）" }}"
                class="w-full px-4 py-3 rounded-md bg-white/10 dark:bg-gray-700 border border-white/20 dark:border-gray-600 text-white dark:text-gray-100 placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-secondary dark:focus:ring-secondary focus:border-transparent transition-all"
              >
            </div>
          </div>

          <!-- 感兴趣的服务 -->
          <div>
            <label for="interest" class="block text-sm font-medium mb-2 dark:text-gray-200">
              {{ i18n "contact.interest" | default "感兴趣的服务" }}
            </label>
            <select 
              id="interest"
              class="w-full px-4 py-3 rounded-md bg-white/10 dark:bg-gray-700 border border-white/20 dark:border-gray-600 text-white dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-secondary dark:focus:ring-secondary focus:border-transparent transition-all appearance-none bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 fill=%22none%22 viewBox=%220 0 20 20%22%3E%3Cpath stroke=%22%239CA3AF%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22 stroke-width=%221.5%22 d=%22M6 8l4 4 4-4%22/%3E%3C/svg%3E')] bg-[right_0.75rem_center] bg-no-repeat pr-8"
            >
              <option value="" class="text-gray-800 dark:text-gray-200">
                {{ i18n "contact.interest_placeholder" | default "请选择" }}
              </option>
              <option value="advertising" class="text-gray-800 dark:text-gray-200">
                {{ i18n "contact.interest.advertising" | default "广告投放" }}
              </option>
              <option value="social-media" class="text-gray-800 dark:text-gray-200">
                {{ i18n "contact.interest.social_media" | default "社交媒体营销" }}
              </option>
              <option value="integrated" class="text-gray-800 dark:text-gray-200">
                {{ i18n "contact.interest.integrated" | default "整合营销方案" }}
              </option>
              <option value="other" class="text-gray-800 dark:text-gray-200">
                {{ i18n "contact.interest.other" | default "其他服务" }}
              </option>
            </select>
          </div>

          <!-- 留言 -->
          <div>
            <label for="message" class="block text-sm font-medium mb-2 dark:text-gray-200">
              {{ i18n "contact.message" | default "留言" }} *
            </label>
            <textarea 
              id="message" 
              rows="4"
              placeholder="{{ i18n "contact.message_placeholder" | default "请详细描述您的需求或问题（至少5个字）" }}"
              class="w-full px-4 py-3 rounded-md bg-white/10 dark:bg-gray-700 border border-white/20 dark:border-gray-600 text-white dark:text-gray-100 placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-secondary dark:focus:ring-secondary focus:border-transparent transition-all resize-none"
              required
            ></textarea>
            <p id="messageError" class="text-red-400 dark:text-red-500 text-sm hidden mt-1">
              {{ i18n "contact.message_error" | default "请输入留言内容（至少5个字）" }}
            </p>
          </div>

          <!-- 提交按钮（明暗模式 hover/active 效果） -->
          <button 
            type="submit"
            class="w-full bg-secondary dark:bg-secondary-600 hover:bg-secondary/90 dark:hover:bg-secondary-700 active:bg-secondary/80 dark:active:bg-secondary-800 text-white font-medium py-3 px-6 rounded-md transition-all duration-200 transform hover:scale-[1.01] active:scale-[0.99]"
          >
            {{ i18n "contact.submit" | default "提交咨询" }}
          </button>
        </form>
      </div>

      <!-- 联系信息区域（适配明暗模式） -->
      <div class="lg:w-1/2 flex flex-col justify-center">
        <div class="space-y-8">
          <!-- 地址 -->
          <div class="flex items-start gap-4">
            <div class="w-12 h-12 bg-secondary/20 dark:bg-secondary-700/30 rounded-full flex items-center justify-center text-secondary dark:text-secondary-400 text-xl mt-1">
              <i class="fa fa-map-marker"></i>
            </div>
            <div>
              <h3 class="text-xl font-bold mb-2 dark:text-white">
                {{ i18n "contact.address.title" | default "公司地址" }}
              </h3>
              <p class="text-gray-300 dark:text-gray-400">
                {{ i18n "contact.address.content" | default "上海市浦东新区张江高科技园区科苑路88号" }}
              </p>
            </div>
          </div>

          <!-- 电话 -->
          <div class="flex items-start gap-4">
            <div class="w-12 h-12 bg-secondary/20 dark:bg-secondary-700/30 rounded-full flex items-center justify-center text-secondary dark:text-secondary-400 text-xl mt-1">
              <i class="fa fa-phone"></i>
            </div>
            <div>
              <h3 class="text-xl font-bold mb-2 dark:text-white">
                {{ i18n "contact.phone.title" | default "联系电话" }}
              </h3>
              <p class="text-gray-300 dark:text-gray-400">
                {{ i18n "contact.phone.content" | default "400-888-9999" }}
              </p>
              <p class="text-gray-400 dark:text-gray-500 text-sm mt-1">
                {{ i18n "contact.phone.time" | default "周一至周五 9:00-18:00" }}
              </p>
            </div>
          </div>

          <!-- 邮箱 -->
          <div class="flex items-start gap-4">
            <div class="w-12 h-12 bg-secondary/20 dark:bg-secondary-700/30 rounded-full flex items-center justify-center text-secondary dark:text-secondary-400 text-xl mt-1">
              <i class="fa fa-envelope"></i>
            </div>
            <div>
              <h3 class="text-xl font-bold mb-2 dark:text-white">
                {{ i18n "contact.email.title" | default "电子邮箱" }}
              </h3>
              <p class="text-gray-300 dark:text-gray-400">
                {{ i18n "contact.email.content" | default "aboutworks@outlook.com" }}
              </p>
              <p class="text-gray-400 dark:text-gray-500 text-sm mt-1">
                {{ i18n "contact.email.time" | default "我们将在24小时内回复您的邮件" }}
              </p>
            </div>
          </div>
        </div>

        <!-- 社交媒体 -->
        <div class="mt-12">
          <h3 class="text-xl font-bold mb-4 dark:text-white">
            {{ i18n "contact.social.title" | default "关注我们" }}
          </h3>
          <div class="flex gap-4">
            <a href="#" class="w-10 h-10 bg-white/10 dark:bg-gray-700 hover:bg-secondary dark:hover:bg-secondary-600 rounded-full flex items-center justify-center text-white transition-colors" aria-label="微信">
              <i class="fa fa-weixin"></i>
            </a>
            <a href="#" class="w-10 h-10 bg-white/10 dark:bg-gray-700 hover:bg-secondary dark:hover:bg-secondary-600 rounded-full flex items-center justify-center text-white transition-colors" aria-label="微博">
              <i class="fa fa-weibo"></i>
            </a>
            <a href="#" class="w-10 h-10 bg-white/10 dark:bg-gray-700 hover:bg-secondary dark:hover:bg-secondary-600 rounded-full flex items-center justify-center text-white transition-colors" aria-label="领英">
              <i class="fa fa-linkedin"></i>
            </a>
            <a href="#" class="w-10 h-10 bg-white/10 dark:bg-gray-700 hover:bg-secondary dark:hover:bg-secondary-600 rounded-full flex items-center justify-center text-white transition-colors" aria-label="油管">
              <i class="fa fa-youtube-play"></i>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

{{/* 表单验证 + 提交脚本（适配明暗模式提示） */}}
<script>
document.addEventListener('DOMContentLoaded', () => {
  const contactForm = document.getElementById('contactForm');
  if (!contactForm) return;

  // 获取表单元素
  const emailInput = document.getElementById('email');
  const phoneInput = document.getElementById('phone');
  const messageInput = document.getElementById('message');
  const emailError = document.getElementById('emailError');
  const phoneError = document.getElementById('phoneError');
  const messageError = document.getElementById('messageError');

  // 输入时清除错误提示
  emailInput.addEventListener('input', () => emailError.classList.add('hidden'));
  phoneInput.addEventListener('input', () => phoneError.classList.add('hidden'));
  messageInput.addEventListener('input', () => messageError.classList.add('hidden'));

  // 自定义验证规则
  const validateEmail = (email) => {
    const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return re.test(email);
  };

  const validatePhone = (phone) => {
    // 支持手机号/固定电话
    const re = /^(1[3-9]\d{9})|(\d{3,4}-\d{7,8})$/;
    return re.test(phone);
  };

  const validateMessage = (message) => {
    return message.trim().length >= 5;
  };

  // 表单提交处理
  contactForm.addEventListener('submit', async function (e) {
    e.preventDefault();
    let isValid = true;

    // 邮箱验证
    if (!emailInput.value.trim()) {
      emailError.textContent = '请输入邮箱地址';
      emailError.classList.remove('hidden');
      isValid = false;
    } else if (!validateEmail(emailInput.value.trim())) {
      emailError.textContent = '请输入有效的邮箱地址';
      emailError.classList.remove('hidden');
      isValid = false;
    } else {
      emailError.classList.add('hidden');
    }

    // 电话验证
    if (!phoneInput.value.trim()) {
      phoneError.textContent = '请输入联系电话';
      phoneError.classList.remove('hidden');
      isValid = false;
    } else if (!validatePhone(phoneInput.value.trim())) {
      phoneError.textContent = '请输入有效的联系电话（11位手机号/固定电话）';
      phoneError.classList.remove('hidden');
      isValid = false;
    } else {
      phoneError.classList.add('hidden');
    }

    // 留言验证
    if (!messageInput.value.trim()) {
      messageError.textContent = '请输入留言内容';
      messageError.classList.remove('hidden');
      isValid = false;
    } else if (!validateMessage(messageInput.value.trim())) {
      messageError.textContent = '留言内容至少5个字';
      messageError.classList.remove('hidden');
      isValid = false;
    } else {
      messageError.classList.add('hidden');
    }

    if (!isValid) return;

    // 准备表单数据
    const formData = {
      name: document.getElementById('name').value.trim() || '',
      email: emailInput.value.trim(),
      phone: phoneInput.value.trim(),
      company: document.getElementById('company').value.trim() || '',
      interest: document.getElementById('interest').value || '',
      message: messageInput.value.trim(),
      origin: '{{ .Site.Title }}' || '网站咨询', // Hugo 站点标题
      theme: document.documentElement.classList.contains('dark') ? 'dark' : 'light' // 记录提交时的主题模式
    };

    const submitBtn = contactForm.querySelector('button[type="submit"]');
    const originalText = submitBtn.textContent;
    submitBtn.disabled = true;
    submitBtn.textContent = '{{ i18n "contact.submitting" | default "提交中..." }}';

    try {
      const response = await fetch('https://handle.lehuye.com/users/postcontactus', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'authorization': 'keebone'
        },
        body: JSON.stringify(formData),
        mode: 'cors',
        credentials: 'include'
      });

      const result = await response.json();

      if (response.ok) {
        // 适配明暗模式的提示样式（可选：替换为自定义弹窗）
        alert('{{ i18n "contact.success" | default "咨询提交成功，我们将尽快与您联系！" }}');
        contactForm.reset();
      } else {
        throw new Error(result.error || '{{ i18n "contact.fail" | default "提交失败，请稍后重试" }}');
      }
    } catch (error) {
      console.error('提交错误:', error);
      alert(error.message || '{{ i18n "contact.network_error" | default "网络错误，请检查网络连接后重试" }}');
    } finally {
      submitBtn.disabled = false;
      submitBtn.textContent = originalText;
    }
  });

  // 可选：监听系统明暗模式切换，同步表单样式
  window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
    if (e.matches) {
      document.documentElement.classList.add('dark');
    } else {
      document.documentElement.classList.remove('dark');
    }
  });
});
</script>

{{/* 补充Tailwind配置（如需全局配置可移到tailwind.config.js） */}}
<style type="text/tailwindcss">
  @layer utilities {
    .section-padding {
      padding-top: clamp(3rem, 8vw, 6rem);
      padding-bottom: clamp(3rem, 8vw, 6rem);
    }
    .secondary {
      @apply bg-purple-600 dark:bg-purple-700;
    }
    .secondary-600 {
      @apply bg-purple-600;
    }
    .secondary-700 {
      @apply bg-purple-700;
    }
    .secondary-800 {
      @apply bg-purple-800;
    }
    .secondary-400 {
      @apply text-purple-400;
    }
  }
</style>